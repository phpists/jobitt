<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <title>Title</title>
    <link rel="stylesheet" href="{{asset('styles/main.css')}}">
    <link rel="stylesheet" href="{{asset('styles/index.css')}}">
    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
    <script src="{{asset('js/jquery-3.7.1.min.js')}}"></script>
</head>
<body>
<div data-v-5a5f7285="" data-v-0fcbf881="" class="header-subscriptions">
    <div data-v-5a5f7285="" class="header-subscriptions__left"><h2 data-v-5a5f7285="">Introducing the No Hiring Fee
            Package!</h2>
        <div data-v-5a5f7285="" class="header-subscriptions__benefits">
            <p data-v-5a5f7285="">
                <svg data-v-5a5f7285="" width="30" height="30" viewBox="0 0 30 30" fill="none"
                     xmlns="http://www.w3.org/2000/svg">
                    <rect data-v-5a5f7285="" width="30" height="30" rx="5" fill="white"></rect>
                    <path data-v-5a5f7285="" d="M10 15L13.6667 19L21 11" stroke="#23303D" stroke-width="2"
                          stroke-linecap="round"></path>
                </svg>
                Post vacancies
            </p>
            <p data-v-5a5f7285="">
                <svg data-v-5a5f7285="" width="30" height="30" viewBox="0 0 30 30" fill="none"
                     xmlns="http://www.w3.org/2000/svg">
                    <rect data-v-5a5f7285="" width="30" height="30" rx="5" fill="white"></rect>
                    <path data-v-5a5f7285="" d="M10 15L13.6667 19L21 11" stroke="#23303D" stroke-width="2"
                          stroke-linecap="round"></path>
                </svg>
                Hire without commissions
            </p>
        </div>
    </div>
    <div data-v-5a5f7285="" class="header-subscriptions__right"><img data-v-5a5f7285=""
                                                                     src="{{asset('img/subscription-slogan.88fd59d.svg')}}"
                                                                     alt="telegram"
                                                                     class="header-subscriptions__slogan">
        <div data-v-5a5f7285="" class="header-subscriptions__button-decoration"><img data-v-5a5f7285=""
                                                                                     src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjgiIGhlaWdodD0iMzkiIHZpZXdCb3g9IjAgMCA2OCAzOSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMC41MDA3MjcgMTAuNDc2MkMzLjY0MzgzIDE2LjU5NjMgMTMuODQ5MSAyNy45NDcgMjkuNTI1MyAyNC4zODkyQzQ5LjEyMDcgMTkuOTQyIDUyLjcxMjcgLTYuNTMwODcgNDIuMzk1NyAyLjgwMjE0QzMyLjA3ODggMTIuMTM1MSAzNS41MDk1IDM3LjM4MzggNDYuNTExNCAzNy41NDA2QzU5Ljg2NDkgMzcuNzMxIDY1LjI2NTggMTguOTgxNiA2Ni44NDIzIDE3LjE0NjlNNjYuODQyMyAxNy4xNDY5QzY2LjcwNDEgMTcuNzE4NyA2Ni4yNjM5IDIxLjMxMTUgNjcuNTY5IDIzLjEzNjZNNjYuODQyMyAxNy4xNDY5QzY2LjU0NTQgMTcuNzMzNiA2NC40MDA2IDIwLjQzMiA2MS43NTM2IDIwLjY4MTciIHN0cm9rZT0id2hpdGUiLz4KPC9zdmc+Cg=="
                                                                                     alt="telegram"
                                                                                     class="header-subscriptions__decoration1">
            <a data-v-5a5f7285="" href="/register" class="header-subscriptions__link">
                start from $9/month!
            </a> <img data-v-5a5f7285=""
                      src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjgiIGhlaWdodD0iMzkiIHZpZXdCb3g9IjAgMCA2OCAzOSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMC41MDA3MjcgMTAuNDc2MkMzLjY0MzgzIDE2LjU5NjMgMTMuODQ5MSAyNy45NDcgMjkuNTI1MyAyNC4zODkyQzQ5LjEyMDcgMTkuOTQyIDUyLjcxMjcgLTYuNTMwODcgNDIuMzk1NyAyLjgwMjE0QzMyLjA3ODggMTIuMTM1MSAzNS41MDk1IDM3LjM4MzggNDYuNTExNCAzNy41NDA2QzU5Ljg2NDkgMzcuNzMxIDY1LjI2NTggMTguOTgxNiA2Ni44NDIzIDE3LjE0NjlNNjYuODQyMyAxNy4xNDY5QzY2LjcwNDEgMTcuNzE4NyA2Ni4yNjM5IDIxLjMxMTUgNjcuNTY5IDIzLjEzNjZNNjYuODQyMyAxNy4xNDY5QzY2LjU0NTQgMTcuNzMzNiA2NC40MDA2IDIwLjQzMiA2MS43NTM2IDIwLjY4MTciIHN0cm9rZT0id2hpdGUiLz4KPC9zdmc+Cg=="
                      alt="telegram" class="header-subscriptions__decoration2"></div>
    </div>
    <div data-v-5a5f7285="" class="header-subscriptions-close"></div>
</div>
<header class="site_header">
    <div class="site_header__left">
        <div class="menu">
            <a class="is-menu">
                <svg width="17" height="12" viewBox="0 0 17 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M1 1H16" stroke="#23303D" stroke-width="1.5" stroke-linecap="round"></path>
                    <path d="M1 6H16" stroke="#23303D" stroke-width="1.5" stroke-linecap="round"></path>
                    <path d="M1 11H16" stroke="#23303D" stroke-width="1.5" stroke-linecap="round"></path>
                </svg>
            </a>
            <div class="sub-menu">
                <ul data-v-0fcbf881="" class="left-menu">
                    <li data-v-0fcbf881="">
                        <a data-v-0fcbf881="" href="javascript: void(0)" class="">
                            <span data-v-0fcbf881="">Job openings</span>
                            <span data-v-0fcbf881="">
            <svg data-v-0fcbf881="" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path data-v-0fcbf881="" d="M1 6H6M6 6H11M6 6L6 1M6 6V11" stroke="#23303D" stroke-linecap="round"></path>
            </svg>
          </span>
                        </a>
                    </li>
                    <li data-v-0fcbf881="">
                        <a data-v-0fcbf881="" href="/candidates" class=""> All Candidates&nbsp;
                            <!---->
                        </a>
                    </li>
                    <li data-v-0fcbf881="">
                        <a data-v-0fcbf881="" href="/resume-builder" class=""> Resume Builder&nbsp;
                            <!---->
                        </a>
                    </li>
                    <li data-v-0fcbf881="">
                        <a data-v-0fcbf881="" href="/blog" class=""> Blog&nbsp;
                            <!---->
                        </a>
                    </li>
                    <li data-v-0fcbf881="">
                        <a data-v-0fcbf881="" href="/companies" class=""> Companies&nbsp;
                            <!---->
                        </a>
                    </li>
                    <!---->
                </ul>
                <div data-v-0fcbf881="" class="sub-menu_auth">
                    <div data-v-0fcbf881="" class="auth-links">
                        <a data-v-0fcbf881="" href="/login" class="btn-dark signin-link">Sign in</a>
                        <a data-v-0fcbf881="" href="/register" class="btn-dark signup-link">Sign up</a>
                    </div>
                </div>
                <div data-v-0fcbf881="" class="sub-menu_lang">
                    <div data-v-821f6b8e="" data-v-0fcbf881="" class="lang-switcher">
                        <div data-v-821f6b8e="" class="lang-globe">
                            <svg data-v-821f6b8e="" width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path data-v-821f6b8e="" d="M11 21C16.5228 21 21 16.5228 21 11C21 5.47715 16.5228 1 11 1C5.47715 1 1 5.47715 1 11C1 16.5228 5.47715 21 11 21Z" stroke="#23303D" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                <path data-v-821f6b8e="" d="M1 11H21" stroke="#23303D" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                <path data-v-821f6b8e="" d="M11 1C13.5013 3.73835 14.9228 7.29203 15 11C14.9228 14.708 13.5013 18.2616 11 21C8.49872 18.2616 7.07725 14.708 7 11C7.07725 7.29203 8.49872 3.73835 11 1V1Z" stroke="#23303D" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                            </svg>
                        </div>
                        <div data-v-821f6b8e="" class="lang-short-name">
                            <span data-v-821f6b8e="">en</span>
                        </div>
                        <!---->
                    </div>
                </div>
                <!---->
            </div>
        </div>
        <div style="display: flex; align-items: center">
            <img class="logo" src="{{asset('img/header-logo-ua.svg')}}" alt="">
            <a data-v-0fcbf881="" href="https://u24.gov.ua/" target="_blank" class="logo-img-heart">
                <img data-v-0fcbf881="" src="{{asset('img/header-logo-ua-heart.svg')}}" alt="Jobitt" sizes="(max-width: 320px) 17px, 31px" srcset="{{asset('img/header-logo-ua-heart-17.svg')}} 17w, {{asset('img/header-logo-ua-heart.svg')}} 31w" class="logo-img">
            </a>
        </div>
    </div>
    <div class="site_header__right">
        <div class="site_header__right-icon">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 17C13.4183 17 17 13.4183 17 9C17 4.58172 13.4183 1 9 1C4.58172 1 1 4.58172 1 9C1 13.4183 4.58172 17 9 17Z" stroke="#23303D" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> <path data-v-0fcbf881="" d="M18.9999 19L14.6499 14.65" stroke="#23303D" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </div>
        <div class="site_header__search_bar">
            <input class="" placeholder="e.g. Web developer, UI/UX Designer etc.">
        </div>
        <div class="site_header__lang">
            <svg data-v-821f6b8e="" width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><path data-v-821f6b8e="" d="M11 21C16.5228 21 21 16.5228 21 11C21 5.47715 16.5228 1 11 1C5.47715 1 1 5.47715 1 11C1 16.5228 5.47715 21 11 21Z" stroke="#23303D" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> <path data-v-821f6b8e="" d="M1 11H21" stroke="#23303D" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> <path data-v-821f6b8e="" d="M11 1C13.5013 3.73835 14.9228 7.29203 15 11C14.9228 14.708 13.5013 18.2616 11 21C8.49872 18.2616 7.07725 14.708 7 11C7.07725 7.29203 8.49872 3.73835 11 1V1Z" stroke="#23303D" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg>
            <span>EN</span>
            <div class="lang__options">
                <p class="lang__option active" data-value="RU">Russian</p>
                <p class="lang__option" data-value="EN">English</p>
                <p class="lang__option" data-value="UA">Ukrainian</p>
            </div>
        </div>
        <div class="auth-links">
            <a href="" class="btn-dark signin-link">Sign in</a>
            <a href="" class="btn-black signup-link">Sign up</a>
        </div>
    </div>
</header>
<div class="header-additional-menu with-info-block">
    <ul class="main-menu">
        <li><a class="">Job openings</a></li>
        <li><a href="/candidates" class=""> All Candidates&nbsp;<!----></a></li>
        <li><a href="/resume-builder" class=""> Resume Builder&nbsp;<!----></a></li>
        <li><a href="/blog" class=""> Blog&nbsp;<!----></a></li>
        <li><a href="/companies" class=""> Companies&nbsp;<!----></a></li>
    </ul>
    <a href="https://t.me/JOBITT_Ukraine" target="_blank" class="header-additional-menu-telegram">
        Telegram channel
        <span><img data-v-0fcbf881="" src="{{asset('img/telegram.1ac36d5.svg')}}" alt="telegram"></span>
    </a>
</div>
<main>
    <section class="statistics">
        <div id="db-header">
            <h1>Salary Data for <span class="title-underscore">QA Engineer</span> in Israel for 2023</h1>
            <div class="lead">
                In 2023, the field of <span class="field_text"></span> in Israel presents many professional opportunities and challenges. With a salary range from <span class="min_salary"></span> to <span class="max_salary"></span> and an average salary of <span class="median_salary"></span>, experts in this field enjoy high incentives. Significant differences are found in salaries between different regions and genders. The <span class="field_text"></span> also offers a variety of career advancement options, focusing on training and professional development.
                The high-tech industry in Israel, particularly in fields like <span class="field_text"></span>, continues to thrive, offering competitive salaries and benefits. With the constant evolution of technology, professionals in <span class="field_text"></span> are in high demand, reflected in the attractive salary packages.
                Moreover, the industry is known for its dynamic and innovative environment, making it an ideal choice for those seeking growth and challenges. Professionals in <span class="field_text"></span> often have opportunities to work on cutting-edge projects, contributing to significant technological advancements.
                Salary differences are observed based on experience, geographic location, and gender. More experienced professionals in central areas like Tel Aviv tend to earn higher salaries. The gender pay gap, while still present, is gradually narrowing as the industry moves towards more inclusive practices.
                Overall, a career in <span class="field_text"></span> in Israel promises a rewarding professional path with numerous opportunities for growth and development, making it attractive for newcomers and those looking to take their careers to the next level.
            </div>

            <div id="salary-facts">
                <h4>Ile zarabia tester oprogramowania</h4>
                <div id="salary-facts-blocks">


                    <a class="salary-fact" href="/salaries?position=QA_Engineer&amp;workTitle=Junior">
                        <span class="sf-name">Junior</span>
                        <span class="sf-value">6 925 PLN</span>
                    </a>
                    <a class="salary-fact" href="/salaries?position=QA_Engineer&amp;workTitle=Middle">
                        <span class="sf-name">Middle</span>
                        <span class="sf-value">12 684 PLN</span>
                    </a>
                    <a class="salary-fact" href="/salaries?position=QA_Engineer&amp;workTitle=Senior">
                        <span class="sf-name">Senior</span>
                        <span class="sf-value">18 850 PLN</span>
                    </a>
                    <a class="salary-fact" href="/salaries?city=Warsaw&amp;position=QA_Engineer">
                        <span class="sf-name">Warsaw</span>
                        <span class="sf-value">15 197 PLN</span>
                    </a>
                    <a class="salary-fact" href="/salaries?city=Krak%C3%B3w&amp;position=QA_Engineer">
                        <span class="sf-name">Kraków</span>
                        <span class="sf-value">19 000 PLN</span>
                    </a>
                    <a class="salary-fact" href="/salaries?city=Wroc%C5%82aw&amp;position=QA_Engineer">
                        <span class="sf-name">Wrocław</span>
                        <span class="sf-value">15 750 PLN</span>
                    </a>
                    <a class="salary-fact" href="/salaries?position=QA_Engineer&amp;specialization=Automation">
                        <span class="sf-name">Automation</span>
                        <span class="sf-value">18 000 PLN</span>
                    </a>
                    <a class="salary-fact" href="/salaries?position=QA_Engineer&amp;specialization=Manual">
                        <span class="sf-name">Manual</span>
                        <span class="sf-value">11 575 PLN</span>
                    </a>
                    <a class="salary-fact" href="/salaries?position=QA_Engineer&amp;specialization=General">
                        <span class="sf-name">General</span>
                        <span class="sf-value">15 197 PLN</span>
                    </a>

                    <a class="salary-fact anketa" href="/salaries/form" rel="nofollow">
                        <span class="sf-name">Pracujesz jako tester oprogramowania?</span>
                        <span class="sf-value">Dodaj swoją pensję</span>
                    </a>
                </div>
            </div>


        </div>
        <div class="statistics__inputs">
            <div class="statistics__inputs__input_container">
                <label for="position_select">Position</label>
                <select name="position" id="position_select">
                    @foreach($positions as $position)
                        <option @if($position === $selected_position) selected @endif>{{$position}}</option>
                    @endforeach
                </select>
            </div>
            <div class="statistics__inputs__input_container">
                <label for="technology_select">Technology</label>
                <select name="technology" id="technology_select">
                    <option value="">All</option>
                    @foreach($technologies as $technology)
                        <option @if(isset($selected_technology) && $technology === $selected_technology) selected @endif>{{$technology}}</option>
                    @endforeach
                </select>
            </div>
            <div class="statistics__inputs__input_container">
                <label for="city_select">Region</label>
                <select name="location" id="city_select">
                    <option selected value="">All</option>
                    @foreach($location_options as $idx => $location_name)
                        <option @if(isset($selected_location) && $selected_location === $location_name) selected @endif value="{{$idx}}">{{$location_name}}</option>
                    @endforeach
                </select>
            </div>
            <div class="statistics__inputs__input_container">
                <label for="seniority_select">Seniority</label>
                <select name="seniority" id="seniority_select">
                    <option selected value="">All</option>
                    @foreach($seniority_options as $idx => $seniority)
                        <option @if(isset($selected_seniority) && $selected_seniority === $seniority) selected @endif value="{{$idx}}">{{$seniority}}</option>
                    @endforeach
                </select>
            </div>
            <div class="statistics__inputs__input_container">
                <label for="experience_select">Experience</label>
                <select name="experience" id="experience_select">
                    <option value="" selected>All</option>
                    @foreach($exp_options as $idx => $option_name)
                        <option @if(isset($selected_experience) && $selected_experience == $idx) selected @endif value="{{$idx}}">{{$option_name}}</option>
                    @endforeach
                </select>
            </div>
        </div>
        <div id="db-employment">
            <div class="item active">
                <div class="value">
                    <span class="value-num">14,000</span><span class="value-unit"> PLN</span>
                </div>
                <div class="name">Umowa o pracę (UoP)<br>gross/month</div>
            </div>
            <div class="item"><div class="value"><span class="value-num">21,650</span><span class="value-unit"> PLN</span></div><div class="name">Własna działalność / JDG (B2B)<br>net/month</div></div></div>
        <div id="db-charts">
            <div id="db-salary-summary">
                <div class="point quartile q1">
                    <div class="name">Kwartyl 1</div>
                    <div class="value">
                        <span class="value-num">9,000</span>
                        <span class="value-unit"> PLN</span>
                    </div>
                </div>
                <div class="point median"><div class="name">Mediana</div><div class="value"><span class="value-num">14,000</span><span class="value-unit"> PLN</span></div></div><div class="point quartile q3"><div class="name">Kwartyl 3</div><div class="value"><span class="value-num">20,000</span><span class="value-unit"> PLN</span></div></div></div>
            <div id="db-chart"></div>
            <div id="db-chart-text">
                <p>Some text here</p>
            </div>
        </div>
    </section>
    <div id="tooltip">
        <div class="tt-name">48k+</div>
        <div class="tt-value">3.4%</div>
        <div class="tt-answers">21 odpowiedź</div>
    </div>
</main>
<footer><p><span class="footer-copyright">© jobitt 2023</span><span class="footer-rights">. All rights reserved</span></p>
    <p class="footer-terms"><a href="/rules" class="">Terms of Payment</a>
        |
        <a href="/agreement" class="">Privacy policy</a>
        |
        <a href="/outstaffing" class="">Terms of outstaffing</a></p>
</footer>
<script type="module">
    const width = window.innerWidth;
    const height = 750;
    const marginTop = 20;
    const marginRight = 0;
    const marginBottom = 30;
    const marginLeft = 40;
    const tooltipPadding = 5;

    document.addEventListener('DOMContentLoaded', function () {
        document.querySelectorAll('#db-employment .item').forEach((el) => {
            el.addEventListener('click',  function (ev){
                document.querySelector('#db-employment .item.active').classList.remove('active');
                ev.currentTarget.classList.add('active');
            })
        });
        document.querySelector('.site_header__lang').addEventListener('click', function (ev) {

            document.querySelector('.lang__options').classList.toggle('active');
        })
        document.querySelector('.is-menu').addEventListener('click', function () {
            document.querySelector('.sub-menu').classList.toggle('show');
        });
        document.querySelectorAll('.statistics__inputs__input_container select').forEach(
            (el) => {
                el.addEventListener('change', function (ev) {
                    let new_url = '/salaries/' + document.getElementById("position_select").value;
                    let technology = document.getElementById("technology_select").value;
                    if(technology !== '' && ev.currentTarget.id !== 'position_select') {
                        new_url += ('/' + technology);
                    }
                    let position_select = ['position_select', 'technology_select'];
                    let selects = document.querySelectorAll('.statistics__inputs__input_container select');
                    let added_select_idx = 0;
                    selects.forEach((el, idx) => {
                        if (!position_select.includes(el.id) && el.value !== '') {
                            if (added_select_idx === 0) {
                                new_url += '?';
                            }
                            else {
                                new_url += '&';
                            }
                            new_url += (el.name + '=' +el.value);
                            added_select_idx++;
                        }
                    })
                    location.href = new_url;
                });
            }
        )
        fetchData();
    })
    function prepareData(rowData) {
        const groupData = d3.group(rowData, (sample) => sample['Salary Range']);
        let preparedData = [];
        groupData.forEach((sample, key) => {
            preparedData.push({
                'count': sample.length,
                'range': key,
                'percent': (sample.length / rowData.length * 100).toFixed(2) + '%'
            })
        })
        return preparedData;
    }
    function plotSallaryChart(data) {
        // Declare the x (horizontal position) scale.
        const x = d3.scaleBand()
            .domain(d3.groupSort(data, ([d]) => d.range, (d) => d.range)) // descending frequency
            .range([marginLeft, width - marginRight])
            .padding(0.1);

        // Declare the y (vertical position) scale.
        const y = d3.scaleLinear()
            .domain([0, d3.max(data, (d) => d.count)])
            .range([height - marginBottom, marginTop]);

        // Create the SVG container.
        const svg = d3.create("svg")
            .attr("width", width)
            .attr("height", height)
            .attr("viewBox", [0, 0, width, height])
            .attr("style", "max-width: 100%; height: auto;");

        // Add a rect for each bar.
        svg.append("g")
            .attr("fill", "#f5750c")
            .selectAll()
            .data(data)
            .join("rect")
            .attr("x", (d) => x(d.range))
            .attr("y", (d) => y(0))
            .attr("data-range", (d) => d.range)
            .attr("data-count", (d) => d.count)
            .attr("data-percent", (d) => d.percent)
            .attr("height", d => height - y(0) - marginBottom)
            .attr("width", x.bandwidth())
            .append("svg:title")
            .text((d) => d.count);

        const tooltip = document.getElementById("tooltip");

        svg.selectAll('rect')
            .transition()
            .delay(200)
            .attr("y", (d) => y(d.count))
            .attr("height", d => height - y(d.count) - marginBottom)
            .duration(500);

        svg.selectAll('rect')
            .on("mouseover", function(d){
                // console.log(d.target.getBoundingClientRect());
                let element = d.target.getBoundingClientRect();
                tooltip.style.top = (element.y + window.scrollY - tooltip.getBoundingClientRect().height - tooltipPadding) + "px";
                tooltip.style.left = element.left + "px";
                tooltip.style.width = element.width + "px";
                tooltip.style.visibility = "visible";
                tooltip.querySelector('.tt-name').innerText = d.target.dataset.range;
                tooltip.querySelector('.tt-value').innerText = d.target.dataset.percent;
                tooltip.querySelector('.tt-answers').innerText = d.target.dataset.count + " responses";
            })
            // .on("mousemove", function(){ console.log('test'); return tooltip.style("top", "200px").style("left",(d3.event.pageX+10)+"px");})
            .on("mouseout", function(){tooltip.style.visibility = "hidden";});

        // Add the x-axis and label.
        svg.append("g")
            .attr("transform", `translate(0,${height - marginBottom})`)
            .attr("style", "font-size: 24px; font-weight: 600")
            .call(g => g.select(".domain").remove())
            .call(d3.axisBottom(x).tickSizeOuter(0));

        // Return the SVG element.
        const div = document.querySelector("#db-chart");
        div.innerHTML = "";
        div.append(svg.node());
    }
    function fetchData() {
        let filters = document.querySelectorAll('.statistics__inputs__input_container select');
        let options = {};
        filters.forEach((filterOption) => {
            if (filterOption.value !== '') {
                options[filterOption.getAttribute('name')] = filterOption.value;
            }
        });
        $.ajax({
            url: '/api/salaries',
            data: options,
            success: (data) => {
                let job_name = options.hasOwnProperty('technology')?options['technology']: options['position'];
                document.querySelector('#db-header .title-underscore').innerText = job_name;
                document.querySelectorAll('.lead .field_text').forEach((el) => {
                    el.innerText = job_name;
                });
                let preparedData = prepareData(data);
                let min_salary = 0;
                let max_salary = 0;
                let f_quantile = 0;
                let m_quantile = 0;
                let th_quantile = 0;
                const div = document.querySelector("#db-chart");
                div.innerHTML = `<div style='height: ${height}px'>
                        <p style="font-weight: 600; font-size: 24px">Not enough data to display</p>
                    </div>`;
                if (preparedData.length !== 0) {
                    f_quantile = d3.quantile(data.map((data) => data['Salary (₪)']), .25);
                    m_quantile = d3.quantile(data.map((data) => data['Salary (₪)']), .5);
                    th_quantile = d3.quantile(data.map((data) => data['Salary (₪)']), .75);
                    max_salary = d3.max(data.map((data) => data['Salary (₪)']))
                    min_salary = d3.min(data.map((data) => data['Salary (₪)']))
                    plotSallaryChart(preparedData);
                }
                document.querySelector('.q1 .value-num').innerText = f_quantile;
                document.querySelector('.median .value-num').innerText = m_quantile;
                document.querySelector('.q3 .value-num').innerText = th_quantile;
                document.querySelector('#db-employment .value-num').innerText = m_quantile;
                document.querySelector('.lead .max_salary').innerText = max_salary;
                document.querySelector('.lead .median_salary').innerText = m_quantile;
                document.querySelector('.lead .min_salary').innerText = min_salary;
            }
        })
    }
</script>
</body>
</html>
